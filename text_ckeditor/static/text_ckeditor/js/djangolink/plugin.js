var DjangoLink=function(f){CKEDITOR.plugins.add("djangolink",{requires:"dialog,fakeobjects",icons:"DjangoLink",hidpi:!0,onLoad:function(){function a(a){return c.replace(/%1/g,"rtl"==a?"right":"left").replace(/%2/g,"cke_contents_"+a)}var b="background:url("+CKEDITOR.getUrl(this.path+"images"+(CKEDITOR.env.hidpi?"/hidpi":"")+"/anchor.png")+") no-repeat %1 center;border:1px dotted #00f;background-size:16px;",c=".%2 a.cke_anchor,.%2 a.cke_anchor_empty,.cke_editable.%2 a[name],.cke_editable.%2 a[data-cke-saved-name]{"+
b+"padding-%1:18px;cursor:auto;}.%2 img.cke_anchor{"+b+"width:16px;min-height:15px;height:1.15em;vertical-align:text-bottom;}";CKEDITOR.addCss(a("ltr")+a("rtl"))},init:function(a){var b=this;CKEDITOR.dialog.add("djangolink",b.path+"dialogs/djangolink.js");a.addCommand("djangolink",{allowedContent:"a[!href, data-*]",requiredContent:"a[href]",exec:function(){var c=a.getSelection(),c=c.getSelectedElement()||c.getCommonAncestor().getAscendant("a",!0);b.editLink(c,a)}});a.ui.addButton("DjangoLink",{label:a.lang.link.toolbar,
command:"djangolink",toolbar:"djangolinks,10",icon:"link"});a.on("doubleclick",function(b){var e=CKEDITOR.plugins.link.getSelectedLink(a)||b.data.element;!e.isReadOnly()&&e.is("a")&&(b.data.dialog="djangolink",b.data.link=e);b.data.dialog in{djangolink:1,anchor:1}&&b.data.link&&a.getSelection().selectElement(b.data.link)},null,null,0)},editLink:function(a,b){f("body");b.openDialog("djangolink")},afterInit:function(a){}});CKEDITOR.plugins.djangolink={getLinkAttributes:function(a,b,c){a={"data-djangolink":!0};
var e=["_popup","_save","csrfmiddlewaretoken"],d;for(d in b)0>e.indexOf(d)&&null!=b[d]?a["data-"+d]=b[d]:null===b[d]&&(a["data-"+d]="");a.href="";c&&(a.href=c);return{set:a,removed:CKEDITOR.tools.objectKeys([])}},getSelectedLink:function(a){var b=a.getSelection(),c=b.getSelectedElement();return c&&c.is("a")?c:(b=b.getRanges()[0])?(b.shrink(CKEDITOR.SHRINK_TEXT),a.elementPath(b.getCommonAncestor()).contains("a",1)):null},parseLinkAttributes:function(a){if(!a||!a.$.attributes)return{};var b={};f.each(a.$.attributes,
function(a,e){var d=e.name.substr(5);b[d]=e.value});return b}}}(django.jQuery);
